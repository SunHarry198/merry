!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).window=t.window||{})}(this,function(t){"use strict";function p(t){return~~(1e5*t+(t<0?-.5:.5))/1e5}function q(t,e){return e.totalLength=t.totalLength,t.samples?(e.samples=t.samples.slice(0),e.lookup=t.lookup.slice(0),e.minLength=t.minLength,e.resolution=t.resolution):e.totalPoints=t.totalPoints,e}var A,P=/[achlmqstvz]|(-?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,w=/[\+\-]?\d*\.?\d+e[\+\-]?\d+/gi,B=Math.PI/180,F=(Math.PI,Math.sin),U=Math.cos,Z=Math.abs,$=Math.sqrt,C=Math.atan2,x=1e8;function copyRawPath(t){for(var e=[],n=0;n<t.length;n++)e[n]=q(t[n],t[n].slice(0));return q(t,e)}function transformRawPath(t,e,n,i,s,a,o){for(var r,h,l,c,d,u=t.length;-1<--u;)for(h=(r=t[u]).length,l=0;l<h;l+=2)c=r[l],d=r[l+1],r[l]=c*e+d*i+a,r[l+1]=c*n+d*s+o;return t._dirty=1,t}function arcToSegment(t,e,n,i,s,a,o,r,h){if(t!==r||e!==h){n=Z(n),i=Z(i);var l=s%360*B,c=U(l),d=F(l),u=Math.PI,p=2*u,g=(t-r)/2,_=(e-h)/2,f=c*g+d*_,v=-d*g+c*_,m=f*f,b=v*v,y=m/(n*n)+b/(i*i);1<y&&(n=$(y)*n,i=$(y)*i);var A=n*n,P=i*i,w=(A*P-A*b-P*m)/(A*b+P*m);w<0&&(w=0);var x=(a===o?-1:1)*$(w),S=n*v/i*x,C=-i*f/n*x,E=c*S-d*C+(t+r)/2,D=d*S+c*C+(e+h)/2,M=(f-S)/n,k=(v-C)/i,H=(-f-S)/n,T=(-v-C)/i,R=M*M+k*k,N=(k<0?-1:1)*Math.acos(M/$(R)),L=(M*T-k*H<0?-1:1)*Math.acos((M*H+k*T)/$(R*(H*H+T*T)));isNaN(L)&&(L=u),!o&&0<L?L-=p:o&&L<0&&(L+=p),N%=p,L%=p;var X,I=Math.ceil(Z(L)/(p/4)),q=[],z=L/I,V=4/3*F(z/2)/(1+U(z/2)),G=c*n,O=d*n,j=d*-i,Y=c*i;for(X=0;X<I;X++)f=U(s=N+X*z),v=F(s),M=U(s+=z),k=F(s),q.push(f-V*v,v+V*f,M+V*k,k-V*M,M,k);for(X=0;X<q.length;X+=2)f=q[X],v=q[X+1],q[X]=f*G+v*j+E,q[X+1]=f*O+v*Y+D;return q[X-2]=r,q[X-1]=h,q}}function stringToRawPath(t){function gd(t,e,n,i){c=(n-t)/3,d=(i-e)/3,r.push(t+c,e+d,n-c,i-d,n,i)}var e,n,i,s,a,o,r,h,l,c,d,u,p,g=(t+"").replace(w,function(t){var e=+t;return e<1e-4&&-1e-4<e?0:e}).match(P)||[],_=[],f=0,v=0,m=g.length,b=0,y="ERROR: malformed path: "+t;if(!t||!isNaN(g[0])||isNaN(g[1]))return console.log(y),_;for(e=0;e<m;e++)if(p=a,isNaN(g[e])?o=(a=g[e].toUpperCase())!==g[e]:e--,i=+g[e+1],s=+g[e+2],o&&(i+=f,s+=v),e||(h=i,l=s),"M"===a)r&&(r.length<8?_.length-=1:b+=r.length),f=h=i,v=l=s,r=[i,s],_.push(r),e+=2,a="L";else if("C"===a)o||(f=v=0),(r=r||[0,0]).push(i,s,f+1*g[e+3],v+1*g[e+4],f+=1*g[e+5],v+=1*g[e+6]),e+=6;else if("S"===a)c=f,d=v,"C"!==p&&"S"!==p||(c+=f-r[r.length-4],d+=v-r[r.length-3]),o||(f=v=0),r.push(c,d,i,s,f+=1*g[e+3],v+=1*g[e+4]),e+=4;else if("Q"===a)c=f+2/3*(i-f),d=v+2/3*(s-v),o||(f=v=0),f+=1*g[e+3],v+=1*g[e+4],r.push(c,d,f+2/3*(i-f),v+2/3*(s-v),f,v),e+=4;else if("T"===a)c=f-r[r.length-4],d=v-r[r.length-3],r.push(f+c,v+d,i+2/3*(f+1.5*c-i),s+2/3*(v+1.5*d-s),f=i,v=s),e+=2;else if("H"===a)gd(f,v,f=i,v),e+=1;else if("V"===a)gd(f,v,f,v=i+(o?v-f:0)),e+=1;else if("L"===a||"Z"===a)"Z"===a&&(i=h,s=l,r.closed=!0),("L"===a||.5<Z(f-i)||.5<Z(v-s))&&(gd(f,v,i,s),"L"===a&&(e+=2)),f=i,v=s;else if("A"===a){if(u=arcToSegment(f,v,+g[e+1],+g[e+2],+g[e+3],+g[e+4],+g[e+5],(o?f:0)+1*g[e+6],(o?v:0)+1*g[e+7]))for(n=0;n<u.length;n++)r.push(u[n]);f=r[r.length-2],v=r[r.length-1],e+=7}else console.log(y);return(e=r.length)<6?(_.pop(),e=0):r[0]===r[e-2]&&r[1]===r[e-1]&&(r.closed=!0),_.totalPoints=b+e,_}function bezierToPoints(t,e,n,i,s,a,o,r,h,l,c){var d,u=(t+n)/2,p=(e+i)/2,g=(n+s)/2,_=(i+a)/2,f=(s+o)/2,v=(a+r)/2,m=(u+g)/2,b=(p+_)/2,y=(g+f)/2,A=(_+v)/2,P=(m+y)/2,w=(b+A)/2,x=o-t,S=r-e,C=Z((n-o)*S-(i-r)*x),E=Z((s-o)*S-(a-r)*x);return l||(l=[t,e,o,r],c=2),l.splice(c||l.length-2,0,P,w),h*(x*x+S*S)<(C+E)*(C+E)&&(d=l.length,bezierToPoints(t,e,u,p,m,b,P,w,h,l,c),bezierToPoints(P,w,y,A,f,v,o,r,h,l,c+2+(l.length-d))),l}function pointsToSegment(t,e,n){var i,s,a,o,r,h,l,c,d,u,g,_,f,v,m=t.length-2,b=+t[0],y=+t[1],A=+t[2],P=+t[3],w=[b,y,b,y],x=A-b,S=P-y;for(isNaN(n)&&(n=Math.PI/10),e=e||0===e?+e:1,r=2;r<m;r+=2)i=b,s=y,b=A,y=P,_=(h=x)*h+(c=S)*c,f=(x=(A=+t[r+2])-b)*x+(S=(P=+t[r+3])-y)*S,v=(l=A-i)*l+(d=P-s)*d,g=(a=Math.acos((_+f-v)/$(4*_*f)))/Math.PI*e,u=$(_)*g,g*=$(f),b===i&&y===s||(n<a?(o=C(d,l),w.push(p(b-U(o)*u),p(y-F(o)*u),p(b),p(y),p(b+U(o)*g),p(y+F(o)*g))):(o=C(c,h),w.push(p(b-U(o)*u),p(y-F(o)*u)),o=C(S,x),w.push(p(b),p(y),p(b+U(o)*g),p(y+F(o)*g))));return w.push(p(A),p(P),p(A),p(P)),w}function simplifyPoints(t,e){var n,i,s,a,o,r,h,l=parseFloat(t[0]),c=parseFloat(t[1]),d=[l,c],u=t.length-2;for(e=Math.pow(e||1,2),n=2;n<u;n+=2)e<(a=l-(i=parseFloat(t[n])))*a+(o=c-(s=parseFloat(t[n+1])))*o&&(d.push(i,s),l=i,c=s);return d.push(parseFloat(t[u]),parseFloat(t[1+u])),function simplifyStep(t,e,n,i,s){var a,o,r,h,l,c,d,u,p,g,_,f,v=i,m=t[e],b=t[e+1],y=t[n],A=t[n+1];for(o=e+2;o<n;o+=2)h=t[o],l=t[o+1],g=void 0,f=(p=A)-(d=b),((_=(u=y)-(c=m))||f)&&(1<(g=((h-c)*_+(l-d)*f)/(_*_+f*f))?(c=u,d=p):0<g&&(c+=_*g,d+=f*g)),v<(r=Math.pow(h-c,2)+Math.pow(l-d,2))&&(a=o,v=r);i<v&&(2<a-e&&simplifyStep(t,e,a,i,s),s.push(t[a],t[a+1]),2<n-a&&simplifyStep(t,a,n,i,s))}(d,0,h=d.length-2,e,r=[d[0],d[1]]),r.push(d[h],d[1+h]),r}function getClosestProgressOnBezier(t,e,n,i,s,a,o,r,h,l,c,d,u,p){var g,_,f,v,m=(s-i)/a,b=0,y=i;for(A=x;y<=s;)(g=(_=(v=1-y)*v*v*o+3*v*v*y*h+3*v*y*y*c+y*y*y*u-e)*_+(f=v*v*v*r+3*v*v*y*l+3*v*y*y*d+y*y*y*p-n)*f)<A&&(A=g,b=y),y+=m;return 1<t?getClosestProgressOnBezier(t-1,e,n,Math.max(b-m,0),Math.min(b+m,1),a,o,r,h,l,c,d,u,p):b}function G(t){return t.ownerSVGElement||("svg"===(t.tagName+"").toLowerCase()?t:null)}function H(t,e){if(t.parentNode&&(l||function _setDoc(t){var e=t.ownerDocument||t;!(v in t.style)&&"msTransform"in t.style&&(m=(v="msTransform")+"Origin");for(;e.parentNode&&(e=e.parentNode););return c=window,f=new S,e&&(d=(l=e).documentElement,u=e.body),e}(t))){var n=G(t),i=n?n.getAttribute("xmlns")||"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",s=n?e?"rect":"g":"div",a=2!==e?0:100,o=3===e?100:0,r="position:absolute;display:block;",h=l.createElementNS?l.createElementNS(i.replace(/^https/,"http"),s):l.createElement(s);return e&&(n?(_=_||H(t),h.setAttribute("width",1),h.setAttribute("height",1),h.setAttribute("transform","translate("+a+","+o+")"),_.appendChild(h)):(g||((g=H(t)).style.cssText=r),h.style.cssText=r+"width:1px;height:1px;top:"+o+"px;left:"+a+"px",g.appendChild(h))),h}throw"Need document and parent."}function J(t,e,n,i,s,a,o){return t.a=e,t.b=n,t.c=i,t.d=s,t.e=a,t.f=o,t}var l,c,d,u,g,_,f,e,v="transform",m=v+"Origin",b=[],y=[],S=((e=Matrix2D.prototype).inverse=function inverse(){var t=this.a,e=this.b,n=this.c,i=this.d,s=this.e,a=this.f,o=t*i-e*n;return J(this,i/o,-e/o,-n/o,t/o,(n*a-i*s)/o,-(t*a-e*s)/o)},e.multiply=function multiply(t){var e=this.a,n=this.b,i=this.c,s=this.d,a=this.e,o=this.f,r=t.a,h=t.c,l=t.b,c=t.d,d=t.e,u=t.f;return J(this,r*e+l*i,r*n+l*s,h*e+c*i,h*n+c*s,a+d*e+u*i,o+d*n+u*s)},e.equals=function equals(t){var e=this.a,n=this.b,i=this.c,s=this.d,a=this.e,o=this.f;return e===t.a&&n===t.b&&i===t.c&&s===t.d&&a===t.e&&o===t.f},e.apply=function apply(t,e){void 0===e&&(e={});var n=t.x,i=t.y,s=this.a,a=this.b,o=this.c,r=this.d,h=this.e,l=this.f;return e.x=n*s+i*o+h,e.y=n*a+i*r+l,e},Matrix2D);function Matrix2D(t,e,n,i,s,a){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===s&&(s=0),void 0===a&&(a=0),J(this,t,e,n,i,s,a)}function getGlobalMatrix(t,e){if(!t.parentNode)return new S;var n=G(t)?b:y,i=function _placeSiblings(t){var e,n,i,s,a,o=G(t),r=t===o,h=o?b:y;return t===c?t:(h.length||h.push(H(t,1),H(t,2),H(t,3)),e=o?_:g,o?(i=r?{x:0,y:0}:t.getBBox(),(n=t.transform.baseVal).length?(s=(n=n.consolidate().matrix).a*i.x+n.c*i.y,a=n.b*i.x+n.d*i.y):(n=f,"g"===t.tagName.toLowerCase()?s=a=0:(s=i.x,a=i.y)),e.setAttribute("transform","matrix("+n.a+","+n.b+","+n.c+","+n.d+","+(n.e+s)+","+(n.f+a)+")"),(r?o:t.parentNode).appendChild(e)):(e.style.top=t.offsetTop+"px",e.style.left=t.offsetLeft+"px",n=c.getComputedStyle(t),e.style[v]=n[v],e.style[m]=n[m],t.parentNode.appendChild(e)),e)}(t),s=n[0].getBoundingClientRect(),a=n[1].getBoundingClientRect(),o=n[2].getBoundingClientRect(),r=i.parentNode,h=new S((a.left-s.left)/100,(a.top-s.top)/100,(o.left-s.left)/100,(o.top-s.top)/100,s.left+function _getDocScrollLeft(){return c.pageXOffset||l.scrollLeft||d.scrollLeft||u.scrollLeft||0}(),s.top+function _getDocScrollTop(){return c.pageYOffset||l.scrollTop||d.scrollTop||u.scrollTop||0}());return r.removeChild(i),e?h.inverse():h}function W(){return 0}function ha(t){t.preventDefault&&(t.preventDefault(),t.preventManipulation&&t.preventManipulation())}function ja(t,e,n){var i,s=E.createElementNS("http://www.w3.org/2000/svg",t),a=/([a-z])([A-Z])/g;for(i in(n=n||{}).class=n.class||"path-editor",n)void 0!==s.style[i]?s.style[i]=n[i]:s.setAttributeNS(null,i.replace(a,"$1-$2").toLowerCase(),n[i]);return e.appendChild(s),s}function la(t){return(t.transform.baseVal.consolidate()||et).matrix}function na(t){return~~(1e3*t+(t<0?-.5:.5))/1e3}function qa(t){if(!t.target._gsSelection&&!V&&100<I()-z){for(var e=tt.length;-1<--e;)tt[e].deselect();tt.length=0}}function ua(t,e,n,i){if(t.addEventListener){var s=T[e];i=i||{passive:!1},t.addEventListener(s||e,n,i),s&&e!==s&&"pointer"!==s.substr(0,7)&&t.addEventListener(e,n,i)}else t.attachEvent&&t.attachEvent("on"+e,n)}function va(t,e,n){if(t.removeEventListener){var i=T[e];t.removeEventListener(i||e,n),i&&e!==i&&"pointer"!==i.substr(0,7)&&t.removeEventListener(e,n)}else t.detachEvent&&t.detachEvent("on"+e,n)}function xa(t){nt=t.touches&&_dragCount<t.touches.length,va(t.target,"touchend",xa)}function ya(t){nt=t.touches&&_dragCount<t.touches.length,ua(t.target,"touchend",xa)}function za(e,n){return function(t){return e.call(n,t)}}function Aa(t,e,n){var i=e.vars[t];return i&&i.call(e.vars.callbackScope||e,n||e),e}function Ca(){E=document,n=window,i=E.body,a=function _createElement(t){return E.createElementNS?E.createElementNS("http://www.w3.org/1999/xhtml",t):E.createElement(t)}("div"),T=function(t){for(var e=t.split(","),n=(void 0!==a.onpointerdown?"pointerdown,pointermove,pointerup,pointercancel":void 0!==a.onmspointerdown?"MSPointerDown,MSPointerMove,MSPointerUp,MSPointerCancel":t).split(","),i={},s=4;-1<--s;)i[e[s]]=n[s],i[n[s]]=e[s];return i}("touchstart,touchmove,touchend,touchcancel"),SVGElement.prototype.getTransformToElement=SVGElement.prototype.getTransformToElement||function(t){return t.getScreenCTM().inverse().multiply(this.getScreenCTM())},E.addEventListener("keydown",function(t){var e,n,i,s,a=t.key||t.which;if("Shift"===a||16===a)M=!0;else if("Control"===a||17===a)o=!0;else if("Meta"===a||91===a)r=!0;else if("Alt"===a||18===a)for(D=!0,e=tt.length;-1<--e;)tt[e]._onPressAlt();else if(("z"===a||90===a)&&(o||r)&&1<j.length){if(j.shift(),n=j[0]){for((s=n.path).path.setAttribute("d",n.d),s.path.setAttribute("transform",n.transform),s.init(),i=s._anchors,e=0;e<i.length;e++)-1!==n.selectedIndexes.indexOf(i[e].i)&&s._selectedAnchors.push(i[e]);s._updateAnchors(),s.update(),s.vars.onUndo&&s.vars.onUndo.call(s)}}else if("Delete"===a||"Backspace"===a||8===a||46===a||63272===a||"d"===a&&(o||r))for(e=tt.length;-1<--e;)tt[e]._deleteSelectedAnchors();else if(("a"===a||65===a)&&(r||o))for(e=tt.length;-1<--e;)tt[e].select(!0)}),E.addEventListener("keyup",function(t){var e=t.key||t.which;if("Shift"===e||16===e)M=!1;else if("Control"===e||17===e)o=!1;else if("Meta"===e||91===e)r=!1;else if("Alt"===e||18===e){D=!1;for(var n=tt.length;-1<--n;)tt[n]._onReleaseAlt()}}),h=!!n.PointerEvent,ua(E,"mouseup",qa),ua(E,"touchend",qa),ua(E,"touchcancel",W),ua(n,"touchmove",W),i&&i.addEventListener("touchstart",W),R=1}function Da(t){var e,n,i=this,s=getGlobalMatrix(i.target.parentNode,!0);this._matrix=this.target.transform.baseVal.getItem(0).matrix,this._ctm=s,T[t.type]?(e=-1!==t.type.indexOf("touch")?t.currentTarget||t.target:E,ua(e,"touchend",i._onRelease),ua(e,"touchmove",i._onMove),ua(e,"touchcancel",i._onRelease),ua(E,"touchstart",ya)):(e=null,ua(E,"mousemove",i._onMove)),h||ua(E,"mouseup",i._onRelease),ha(t),t.changedTouches?(t=i.touch=t.changedTouches[0],i.touchID=t.identifier):t.pointerId?i.touchID=t.pointerId:i.touch=i.touchID=null,i._startPointerY=i.pointerY=t.pageY,i._startPointerX=i.pointerX=t.pageX,i._startElementX=i._matrix.e,i._startElementY=i._matrix.f,1===this._ctm.a&&0===this._ctm.b&&0===this._ctm.c&&1===this._ctm.d?this._ctm=null:(n=i._startPointerX*this._ctm.a+i._startPointerY*this._ctm.c+this._ctm.e,i._startPointerY=i._startPointerX*this._ctm.b+i._startPointerY*this._ctm.d+this._ctm.f,i._startPointerX=n),i.isPressed=V=!0,i.touchEventTarget=e,i.vars.onPress&&i.vars.onPress.call(i.vars.callbackScope||i,i.pointerEvent)}function Ea(t){var e,n,i=this,s=t;if(i._enabled&&!nt&&i.isPressed&&t){if(e=(i.pointerEvent=t).changedTouches){if((t=e[0])!==i.touch&&t.identifier!==i.touchID){for(n=e.length;-1<--n&&(t=e[n]).identifier!==i.touchID;);if(n<0)return}}else if(t.pointerId&&i.touchID&&t.pointerId!==i.touchID)return;ha(s),i.setPointerPosition(t.pageX,t.pageY),i.vars.onDrag&&i.vars.onDrag.call(i.vars.callbackScope||i,i.pointerEvent)}}function Fa(t,e){var n=this;if(n._enabled&&n.isPressed&&(!t||null==n.touchID||e||!(t.pointerId&&t.pointerId!==n.touchID||t.changedTouches&&!function _hasTouchID(t,e){for(var n=t.length;-1<--n;)if(t[n].identifier===e)return!0;return!1}(t.changedTouches,n.touchID)))){!function _interacted(){z=I()}(),n.isPressed=V=!1;var i,s,a=t,o=n.isDragging,r=n.touchEventTarget;if(r?(va(r,"touchend",n._onRelease),va(r,"touchmove",n._onMove),va(r,"touchcancel",n._onRelease),va(E,"touchstart",ya)):va(E,"mousemove",n._onMove),h||(va(E,"mouseup",n._onRelease),t&&t.target&&va(t.target,"mouseup",n._onRelease)),o?n.isDragging=!1:n.vars.onClick&&n.vars.onClick.call(n.vars.callbackScope||n,a),t){if((i=t.changedTouches)&&(t=i[0])!==n.touch&&t.identifier!==n.touchID){for(s=i.length;-1<--s&&(t=i[s]).identifier!==n.touchID;);if(s<0)return}n.pointerEvent=a,n.pointerX=t.pageX,n.pointerY=t.pageY}return a&&!o&&n.vars.onDragRelease?n.vars.onDragRelease.call(n,n.pointerEvent):(a&&ha(a),n.vars.onRelease&&n.vars.onRelease.call(n.vars.callbackScope||n,n.pointerEvent)),o&&n.vars.onDragEnd&&n.vars.onDragEnd.call(n.vars.callbackScope||n,n.pointerEvent),!0}}function Ga(t,e,n,i){var s,a=t[e].length,o=[];for(s=0;s<a;s+=6)o.push(new at(n,t,e,s,i));return o}function Ha(t,e,n){var i=t[n]-t[e],s=t[n+1]-t[e+1];return Math.sqrt(i*i+s*s)}var E,h,n,i,o,D,M,r,k,a,T,R,s,N=/(?:(-)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,L="#4e7fff",X=Math.PI/180,I=Date.now||function(){return(new Date).getTime()},z=0,V=0,O={},j=[],Y={},K=[],Q=",",tt=[],et={matrix:{a:1,b:0,c:0,d:1,e:0,f:0}},nt=0,it=((s=DraggableSVG.prototype).setPointerPosition=function setPointerPosition(t,e){var n,i,s,a,o;this.pointerX=t,this.pointerY=e,this._ctm&&(o=t*this._ctm.a+e*this._ctm.c+this._ctm.e,e=t*this._ctm.b+e*this._ctm.d+this._ctm.f,t=o),(i=e-this._startPointerY)<1&&-1<i&&(i=0),(n=t-this._startPointerX)<1&&-1<n&&(n=0),s=(1e3*(this._startElementX+n)|0)/1e3,a=(1e3*(this._startElementY+i)|0)/1e3,this.snap&&!M&&(Y.x=s,Y.y=a,this.snap.call(this,Y),s=Y.x,a=Y.y),this.x===s&&this.y===a||(this._matrix.f=this.y=a,this._matrix.e=this.x=s,!this.isDragging&&this.isPressed&&(this.isDragging=!0,Aa("onDragStart",this,this.pointerEvent)))},s.enabled=function enabled(t){return arguments.length?((this._enabled=t)?(h||ua(this.target,"mousedown",this._onPress),ua(this.target,"touchstart",this._onPress),ua(this.target,"click",this._onClick,!0)):(e=this.isDragging,va(this.target,"mousedown",this._onPress),va(this.target,"touchstart",this._onPress),va(this.target,"click",this._onClick),this.touchEventTarget&&(va(this.touchEventTarget,"touchcancel",this._onRelease),va(this.touchEventTarget,"touchend",this._onRelease),va(this.touchEventTarget,"touchmove",this._onMove)),va(E,"mouseup",this._onRelease),va(E,"mousemove",this._onMove),this.isDragging=this.isPressed=!1,e&&Aa("onDragEnd",this,this.pointerEvent)),this):this._enabled;var e},s.endDrag=function endDrag(t){this._onRelease(t)},DraggableSVG);function DraggableSVG(t,e){this.target="string"==typeof t?E.querySelectorAll(t)[0]:t,this.vars=e||{},this._onPress=za(Da,this),this._onMove=za(Ea,this),this._onRelease=za(Fa,this),this.target.setAttribute("transform",(this.target.getAttribute("transform")||"")+" translate(0,0)"),this._matrix=this.target.transform.baseVal.getItem(0).matrix,this.x=this._matrix.e,this.y=this._matrix.f,this.snap=e.snap,isNaN(e.maxX)&&isNaN(e.minX)?this._bounds=0:(this._bounds=1,this.maxX=+e.maxX,this.minX=+e.minX),this.enabled(!0)}var st,at=((st=Anchor.prototype).onPress=function onPress(){Aa("onPress",this)},st.onClick=function onClick(){Aa("onClick",this)},st.onDrag=function onDrag(){var t=this.segment;this.vars.onDrag.call(this.vars.callbackScope||this,this,this._draggable.x-t[this.i],this._draggable.y-t[this.i+1])},st.onDragEnd=function onDragEnd(){Aa("onDragEnd",this)},st.onRelease=function onRelease(){Aa("onRelease",this)},st.update=function update(t,e,n){t&&(this.rawPath=t),arguments.length<=1?(e=this.j,n=this.i):(this.j=e,this.i=n);var i=this.smooth,s=this.rawPath[e];this.segment=s,this.smooth=n&&n<s.length-2&&Math.abs(Math.atan2(s[n+1]-s[n-1],s[n]-s[n-2])-Math.atan2(s[n+3]-s[n+1],s[n+2]-s[n]))<.09?2:0,this.smooth!==i&&this.element.setAttribute("d",this.smooth?this.editor._circleHandle:this.editor._squareHandle),this.element.setAttribute("transform","translate("+s[n]+","+s[n+1]+")")},Anchor);function Anchor(t,e,n,i,s){this.editor=t,this.element=ja("path",t._selection,{fill:L,stroke:L,strokeWidth:2,vectorEffect:"non-scaling-stroke"}),this.update(e,n,i),this.element._gsSelection=!0,this.vars=s||{},this._draggable=new it(this.element,{callbackScope:this,onDrag:this.onDrag,snap:this.vars.snap,onPress:this.onPress,onRelease:this.onRelease,onClick:this.onClick,onDragEnd:this.onDragEnd})}var ot,rt=((ot=PathEditor.prototype)._onRelease=function _onRelease(t){var e=this._editingAnchor;e&&(O.x=e.segment[e.i],O.y=e.segment[e.i+1]),Aa("onRelease",this,t)},ot.init=function init(){var t,e,n=this.path.getAttribute("d"),i=stringToRawPath(n),s=!this._rawPath||i.totalPoints!==this._rawPath.totalPoints||i.length!==this._rawPath.length,a={callbackScope:this,snap:this.vars.anchorSnap,onDrag:this._onDragAnchor,onPress:this._onPressAnchor,onRelease:this._onRelease,onClick:this._onClickAnchor,onDragEnd:this._onDragEndAnchor,maxX:this.vars.maxX,minX:this.vars.minX};if(s&&this._anchors&&this._anchors.length){for(e=0;e<this._anchors.length;e++)this._anchors[e].element.parentNode.removeChild(this._anchors[e].element),this._anchors[e]._draggable.enabled(!1);this._selectedAnchors.length=0}if(this._rawPath=i,s){if(this._anchors=Ga(i,0,this,a),1<(t=i.length))for(e=1;e<t;e++)this._anchors=this._anchors.concat(Ga(i,e,this,a))}else for(e=this._anchors.length;-1<--e;)this._anchors[e].update(i);return this._selection.appendChild(this._handle1),this._selection.appendChild(this._handle2),this._selectionPath.setAttribute("d",n),this._selectionHittest.setAttribute("d",n),this._selection.setAttribute("transform",this.path.getAttribute("transform")||"translate(0,0)"),this._selectionHittest.setAttribute("transform",this._selection.getAttribute("transform")),this._updateAnchors(),this},ot._saveState=function _saveState(){!function _addHistory(t){var e,n=[],i=t._selectedAnchors;for(e=0;e<i.length;e++)n[e]=i[e].i;j.unshift({path:t,d:t.path.getAttribute("d"),transform:t.path.getAttribute("transform")||"",selectedIndexes:n}),30<j.length&&(j.length=30)}(this)},ot._onClickSelectionPath=function _onClickSelectionPath(t){if("hidden"===this._selection.style.visibility)this.select();else if(D||t&&t.altKey){var e,n,i,s,a,o,r={callbackScope:this,snap:this.vars.anchorSnap,onDrag:this._onDragAnchor,onPress:this._onPressAnchor,onRelease:this._onRelease,onClick:this._onClickAnchor,onDragEnd:this._onDragEndAnchor,maxX:this.vars.maxX,minX:this.vars.minX},h=this._selection.getScreenCTM().inverse();for(this._draggable&&this._draggable._onRelease(t),h&&(s=t.clientX*h.a+t.clientY*h.c+h.e,a=t.clientX*h.b+t.clientY*h.d+h.f),o=function getClosestData(t,e,n,i){var s,a,o,r,h={j:0,i:0,t:0},l=x;for(a=0;a<t.length;a++)for(r=t[a],s=0;s<r.length;s+=6)o=getClosestProgressOnBezier(1,e,n,0,1,i||20,r[s],r[s+1],r[s+2],r[s+3],r[s+4],r[s+5],r[s+6],r[s+7]),A<l&&(l=A,h.j=a,h.i=s,h.t=o);return h}(this._rawPath,s,a),function subdivideSegment(t,e,n){if(n<=0||1<=n)return 0;var i=t[e],s=t[e+1],a=t[e+2],o=t[e+3],r=t[e+4],h=t[e+5],l=i+(a-i)*n,c=a+(r-a)*n,d=s+(o-s)*n,u=o+(h-o)*n,g=l+(c-l)*n,_=d+(u-d)*n,f=r+(t[e+6]-r)*n,v=h+(t[e+7]-h)*n;return c+=(f-c)*n,u+=(v-u)*n,t.splice(e+2,4,p(l),p(d),p(g),p(_),p(g+(c-g)*n),p(_+(u-_)*n),p(c),p(u),p(f),p(v)),t.samples&&t.samples.splice(e/6*t.resolution|0,0,0,0,0,0,0,0),6}(this._rawPath[o.j],o.i,o.t),e=o.i+6,n=0;n<this._anchors.length;n++)this._anchors[n].i>=e&&(this._anchors[n].i+=6);i=new at(this,this._rawPath,o.j,e,r),this._selection.appendChild(this._handle1),this._selection.appendChild(this._handle2),i._draggable._onPress(t),k=i,this._anchors.push(i),this._selectedAnchors.length=0,this._selectedAnchors.push(i),this._updateAnchors(),this.update(),this._saveState()}Aa("onPress",this)},ot._onClickHandle1=function _onClickHandle1(){var t=this._editingAnchor,e=t.i,n=t.segment;D&&Math.abs(n[e]-n[e-2])<5&&Math.abs(n[e+1]-n[e-1])<5&&this._onClickAnchor(t)},ot._onClickHandle2=function _onClickHandle2(){var t=this._editingAnchor,e=t.i,n=t.segment;D&&Math.abs(n[e]-n[e+2])<5&&Math.abs(n[e+1]-n[e+3])<5&&this._onClickAnchor(t)},ot._onDragEndAnchor=function _onDragEndAnchor(){k=null,this._saveState()},ot.isSelected=function isSelected(){return 0<this._selectedAnchors.length},ot.select=function select(t){if(this._selection.style.visibility="visible",this._editingAnchor=null,(this.path._gsSelection=!0)===t)for(var e=this._anchors.length;-1<--e;)this._selectedAnchors[e]=this._anchors[e];return-1===tt.indexOf(this)&&tt.push(this),this._updateAnchors(),this},ot.deselect=function deselect(){return this._selection.style.visibility="hidden",this._selectedAnchors.length=0,this._editingAnchor=null,this.path._gsSelection=!1,tt.splice(tt.indexOf(this),1),this._updateAnchors(),this},ot._onDragPath=function _onDragPath(){var t=this._selectionHittest.getAttribute("transform")||"translate(0,0)";this._selection.setAttribute("transform",t),this.path.setAttribute("transform",t)},ot._onPressAnchor=function _onPressAnchor(t){-1===this._selectedAnchors.indexOf(t)?(M||(this._selectedAnchors.length=0),this._selectedAnchors.push(t)):M&&(this._selectedAnchors.splice(this._selectedAnchors.indexOf(t),1),t._draggable.endDrag()),O.x=t.segment[t.i],O.y=t.segment[t.i+1],this._updateAnchors(),Aa("onPress",this)},ot._deleteSelectedAnchors=function _deleteSelectedAnchors(){for(var t,e,n,i=this._selectedAnchors,s=i.length;-1<--s;)for((t=i[s]).element.parentNode.removeChild(t.element),t._draggable.enabled(!1),(e=t.i)?e<t.segment.length-2?t.segment.splice(e-2,6):t.segment.splice(e-4,6):t.segment.splice(e,6),i.splice(s,1),this._anchors.splice(this._anchors.indexOf(t),1),n=0;n<this._anchors.length;n++)this._anchors[n].i>=e&&(this._anchors[n].i-=6);this._updateAnchors(),this.update(),this._saveState(),this.vars.onDeleteAnchor&&this.vars.onDeleteAnchor.call(this.vars.callbackScope||this)},ot._onClickAnchor=function _onClickAnchor(t){var e,n,i,s,a,o,r=t.i,h=t.segment,l=1e3,c=!r||r>=h.length-2;D&&k!==t&&this._editingAnchor?(t.smooth=!t.smooth,c&&(t.smooth=!1),t.element.setAttribute("d",t.smooth?this._circleHandle:this._squareHandle),t.smooth&&!c?(e=((e=Math.atan2(h[r+1]-h[r-1],h[r]-h[r-2]))+(n=Math.atan2(h[r+3]-h[r+1],h[r+2]-h[r])))/2,i=Ha(h,r-2,r),s=Ha(h,r,r+2),i<.2&&(i=Ha(h,r,r-6)/4,e=n||Math.atan2(h[r+7]-h[r-5],h[r+6]-h[r-6])),s<.2&&(s=Ha(h,r,r+6)/4,n=e||Math.atan2(h[r+7]-h[r-5],h[r+6]-h[r-6])),a=Math.sin(e),o=Math.cos(e),Math.abs(n-e)<Math.PI/2&&(a=-a,o=-o),h[r-2]=((h[r]+o*i)*l|0)/l,h[r-1]=((h[r+1]+a*i)*l|0)/l,h[r+2]=((h[r]-o*s)*l|0)/l,h[r+3]=((h[r+1]-a*s)*l|0)/l,this._updateAnchors(),this.update(),this._saveState()):t.smooth||c||(r&&(h[r-2]=h[r],h[r-1]=h[r+1]),r<h.length-2&&(h[r+2]=h[r],h[r+3]=h[r+1]),this._updateAnchors(),this.update(),this._saveState())):M||(this._selectedAnchors.length=0,this._selectedAnchors.push(t)),k=null,this._updateAnchors()},ot._updateAnchors=function _updateAnchors(){var t,e,n,i=1===this._selectedAnchors.length?this._selectedAnchors[0]:null,s=i?i.segment:null;for(this._editingAnchor=i,t=0;t<this._anchors.length;t++)this._anchors[t].element.style.fill=-1!==this._selectedAnchors.indexOf(this._anchors[t])?L:"white";i&&(this._handle1.setAttribute("d",i.smooth?this._circleHandle:this._squareHandle),this._handle2.setAttribute("d",i.smooth?this._circleHandle:this._squareHandle)),t=i?i.i:0,i&&t?(e=s[t-2],n=s[t-1],this._handle1.style.visibility=this._line1.style.visibility=D||e!==s[t]||n!==s[t+1]?"visible":"hidden",this._handle1.setAttribute("transform","translate("+e+Q+n+")"),this._line1.setAttribute("points",e+Q+n+Q+s[t]+Q+s[t+1])):this._handle1.style.visibility=this._line1.style.visibility="hidden",i&&t<s.length-2?(e=s[t+2],n=s[t+3],this._handle2.style.visibility=this._line2.style.visibility=D||e!==s[t]||n!==s[t+1]?"visible":"hidden",this._handle2.setAttribute("transform","translate("+e+Q+n+")"),this._line2.setAttribute("points",s[t]+Q+s[t+1]+Q+e+Q+n)):this._handle2.style.visibility=this._line2.style.visibility="hidden"},ot._onPressAlt=function _onPressAlt(){var t=this._editingAnchor;t&&(t.i&&(this._handle1.style.visibility=this._line1.style.visibility="visible"),t.i<t.segment.length-2&&(this._handle2.style.visibility=this._line2.style.visibility="visible"))},ot._onReleaseAlt=function _onReleaseAlt(){var t,e,n=this._editingAnchor;n&&((t=n.segment)[e=n.i]===t[e-2]&&t[e+1]===t[e-1]&&(this._handle1.style.visibility=this._line1.style.visibility="hidden"),t[e]===t[e+2]&&t[e+1]===t[e+3]&&(this._handle2.style.visibility=this._line2.style.visibility="hidden"))},ot._onPressHandle1=function _onPressHandle1(){this._editingAnchor.smooth&&(this._oppositeHandleLength=Ha(this._editingAnchor.segment,this._editingAnchor.i,this._editingAnchor.i+2)),Aa("onPress",this)},ot._onPressHandle2=function _onPressHandle2(){this._editingAnchor.smooth&&(this._oppositeHandleLength=Ha(this._editingAnchor.segment,this._editingAnchor.i-2,this._editingAnchor.i)),Aa("onPress",this)},ot._onReleaseHandle=function _onReleaseHandle(t){this._onRelease(t),this._saveState()},ot._onDragHandle1=function _onDragHandle1(){var t,e=this._editingAnchor,n=e.segment,i=e.i,s=1e3,a=this._handle1._draggable.x,o=this._handle1._draggable.y;n[i-2]=a=(a*s|0)/s,n[i-1]=o=(o*s|0)/s,e.smooth&&(D?(e.smooth=!1,e.element.setAttribute("d",this._squareHandle),this._handle1.setAttribute("d",this._squareHandle),this._handle2.setAttribute("d",this._squareHandle)):(t=Math.atan2(n[i+1]-o,n[i]-a),a=this._oppositeHandleLength*Math.cos(t),o=this._oppositeHandleLength*Math.sin(t),n[i+2]=((n[i]+a)*s|0)/s,n[i+3]=((n[i+1]+o)*s|0)/s)),this.update()},ot._onDragHandle2=function _onDragHandle2(){var t,e=this._editingAnchor,n=e.segment,i=e.i,s=1e3,a=this._handle2._draggable.x,o=this._handle2._draggable.y;n[i+2]=a=(a*s|0)/s,n[i+3]=o=(o*s|0)/s,e.smooth&&(D?(e.smooth=!1,e.element.setAttribute("d",this._squareHandle),this._handle1.setAttribute("d",this._squareHandle),this._handle2.setAttribute("d",this._squareHandle)):(t=Math.atan2(n[i+1]-o,n[i]-a),a=this._oppositeHandleLength*Math.cos(t),o=this._oppositeHandleLength*Math.sin(t),n[i-2]=((n[i]+a)*s|0)/s,n[i-1]=((n[i+1]+o)*s|0)/s)),this.update()},ot._onDragAnchor=function _onDragAnchor(t,e,n){var i,s,a,o,r=this._selectedAnchors,h=r.length,l=1e3;for(s=0;s<h;s++)i=(o=r[s]).i,a=o.segment,i&&(a[i-2]=((a[i-2]+e)*l|0)/l,a[i-1]=((a[i-1]+n)*l|0)/l),a[i]=((a[i]+e)*l|0)/l,a[i+1]=((a[i+1]+n)*l|0)/l,i<a.length-2&&(a[i+2]=((a[i+2]+e)*l|0)/l,a[i+3]=((a[i+3]+n)*l|0)/l),o!==t&&o.element.setAttribute("transform","translate("+a[i]+Q+a[i+1]+")");this.update()},ot.enabled=function enabled(t){if(!arguments.length)return this._enabled;for(var e=this._anchors.length;-1<--e;)this._anchors[e]._draggable.enabled(t);return this._enabled=t,this._handle1._draggable.enabled(t),this._handle2._draggable.enabled(t),this._draggable&&this._draggable.enabled(t),t?this._selection.parentNode||(this.path.ownerSVGElement.appendChild(this._selectionHittest),this.path.ownerSVGElement.appendChild(this._selection),this.init(),this._saveState()):(this.deselect(),this.path.ownerSVGElement.removeChild(this._selectionHittest),this.path.ownerSVGElement.removeChild(this._selection)),this._updateAnchors(),this.update()},ot.update=function update(t){var e,n,i,s,a="",o=this._editingAnchor;if(t&&this.init(),o&&(e=o.i,n=o.segment,e&&(i=n[e-2],s=n[e-1],this._handle1.setAttribute("transform","translate("+i+Q+s+")"),this._line1.setAttribute("points",i+Q+s+Q+n[e]+Q+n[e+1])),e<n.length-2&&(i=n[e+2],s=n[e+3],this._handle2.setAttribute("transform","translate("+i+Q+s+")"),this._line2.setAttribute("points",n[e]+Q+n[e+1]+Q+i+Q+s))),t)a=this.path.getAttribute("d");else{for(e=0;e<this._rawPath.length;e++)7<(n=this._rawPath[e]).length&&(a+="M"+n[0]+Q+n[1]+"C"+n.slice(2).join(Q));this.path.setAttribute("d",a),this._selectionPath.setAttribute("d",a),this._selectionHittest.setAttribute("d",a)}return this.vars.onUpdate&&this._enabled&&Aa("onUpdate",this,a),this},ot.getRawPath=function getRawPath(t,e,n){if(t){var i=la(this.path);return transformRawPath(copyRawPath(this._rawPath),1,0,0,1,i.e+(e||0),i.f+(n||0))}return this._rawPath},ot.getString=function getString(t,e,n){if(t){var i=la(this.path);return function rawPathToString(t){!function _isNumber(t){return"number"==typeof t}(t[0])||(t=[t]);var e,n,i,s,a="",o=t.length;for(n=0;n<o;n++){for(s=t[n],a+="M"+p(s[0])+","+p(s[1])+" C",e=s.length,i=2;i<e;i++)a+=p(s[i++])+","+p(s[i++])+" "+p(s[i++])+","+p(s[i++])+" "+p(s[i++])+","+p(s[i])+" ";s.closed&&(a+="z")}return a}(transformRawPath(copyRawPath(this._rawPath),1,0,0,1,i.e+(e||0),i.f+(n||0)))}return this.path.getAttribute("d")},ot.getNormalizedSVG=function getNormalizedSVG(t,e,n,i){var s,a,o,r,h,l,c=this._rawPath[0],d=-1*c[0],u=0===e?0:-(e||c[1]),p=c.length,g=1/(c[p-2]+d),_=-t||c[p-1]+u;for(_=_?1/_:-g,g*=1e3,_*=1e3,a=K.length=0;a<p;a+=2)K[a]=((c[a]+d)*g|0)/1e3,K[a+1]=((c[a+1]+u)*_|0)/1e3;if(i){for(s=[],p=K.length,a=2;a<p;a+=6)o=K[a-2],r=K[a-1],h=K[a+4],l=K[a+5],s.push(o,r,h,l),bezierToPoints(o,r,K[a],K[a+1],K[a+2],K[a+3],h,l,.001,s,s.length-2);for(o=s[0],p=s.length,a=2;a<p;a+=2){if((h=s[a])<o||1<h||h<0){i();break}o=h}}return n&&8===p&&0===K[0]&&0===K[1]&&1===K[p-2]&&1===K[p-1]?K.slice(2,6).join(","):(K[2]="C"+K[2],"M"+K.join(","))},PathEditor);function PathEditor(t,e){e=e||{},R||Ca(),this.vars=e,this.path="string"==typeof t?E.querySelectorAll(t)[0]:t,this._selectionHittest=ja("path",this.path.ownerSVGElement,{stroke:"transparent",strokeWidth:16,fill:"none",vectorEffect:"non-scaling-stroke"}),this._selection=e._selection||ja("g",this.path.ownerSVGElement,{class:"path-editor-selection path-editor"}),this._selectionPath=ja("path",this._selection,{stroke:L,strokeWidth:2,fill:"none",vectorEffect:"non-scaling-stroke"}),this._selectedAnchors=[],this._line1=ja("polyline",this._selection,{stroke:L,strokeWidth:2,vectorEffect:"non-scaling-stroke"}),this._line2=ja("polyline",this._selection,{stroke:L,strokeWidth:2,vectorEffect:"non-scaling-stroke"}),this._line1.style.pointerEvents=this._line2.style.pointerEvents=this._selectionPath.style.pointerEvents="none",this._enabled=!0;var n=this.path.parentNode.getScreenCTM().inverse(),i=(n.a+n.d)/2*(e.handleSize||5);this._squareHandle=function _getSquarePathData(t){return["M-"+(t=na(t)),-t,t,-t,t,t,-t,t+"z"].join(Q)}(i),this._circleHandle=function _getCirclePathData(t){var e=na(.552284749831*t);return"M"+(t=na(t))+",0C"+[t,e,e,t,0,t,-e,t,-t,e,-t,0,-t,-e,-e,-t,0,-t,e,-t,t,-e,t,0].join(Q)+"z"}(1.15*i),this._handle1=ja("path",this._selection,{d:this._squareHandle,fill:L,stroke:"transparent",strokeWidth:6}),this._handle2=ja("path",this._selection,{d:this._squareHandle,fill:L,stroke:"transparent",strokeWidth:6}),this._handle1._draggable=new it(this._handle1,{onDrag:this._onDragHandle1,callbackScope:this,onPress:this._onPressHandle1,onRelease:this._onReleaseHandle,onClick:this._onClickHandle1,snap:e.handleSnap}),this._handle2._draggable=new it(this._handle2,{onDrag:this._onDragHandle2,callbackScope:this,onPress:this._onPressHandle2,onRelease:this._onReleaseHandle,onClick:this._onClickHandle2,snap:e.handleSnap}),this._handle1.style.visibility=this._handle2.style.visibility="hidden";for(var s=[this._handle1,this._handle2,this._line1,this._line2,this._selection,this._selectionPath,this._selectionHittest],a=s.length;-1<--a;)s[a]._gsSelection=!0;!1!==e.draggable&&(this._draggable=new it(this._selectionHittest,{callbackScope:this,onPress:this.select,onRelease:this._onRelease,onDrag:this._onDragPath,onDragEnd:this._saveState,maxX:this.vars.maxX,minX:this.vars.minX})),this.init(),this._selection.style.visibility=!1===e.selected?"hidden":"visible",!1!==e.selected&&(this.path._gsSelection=!0,tt.push(this)),this._saveState(),ua(this._selectionHittest,"mousedown",za(this._onClickSelectionPath,this)),ua(this._selectionHittest,"touchstart",za(this._onClickSelectionPath,this)),ua(this._selectionHittest,"mouseup",za(this._onRelease,this)),ua(this._selectionHittest,"touchend",za(this._onRelease,this))}rt.simplifyPoints=simplifyPoints,rt.pointsToSegment=pointsToSegment,rt.simplifySVG=function(t,e){var n,i,s,a,o,r,h,l,c,d,u,p;if(d=(e=e||{}).tolerance||1,c=e.precision||1/d,p=(void 0===e.cornerThreshold?18:+e.cornerThreshold)*X,"string"!=typeof t&&(t=(n=t).getAttribute("d")),"#"!==t.charAt(0)&&"."!==t.charAt(0)||(n=E.querySelector(t))&&(t=n.getAttribute("d")),i=!1!==e.curved||/[achqstvz]/gi.test(t)?stringToRawPath(t)[0]:t.match(N),!1!==e.curved){for(l=i,i=[],u=l.length,s=2;s<u;s+=6)a=+l[s-2],r=+l[s-1],o=+l[s+4],h=+l[s+5],i.push(na(a),na(r),na(o),na(h)),bezierToPoints(a,r,+l[s],+l[s+1],+l[s+2],+l[s+3],o,h,1/(2e5*c),i,i.length-2);(i=pointsToSegment(simplifyPoints(i,d),e.curviness,p))[2]="C"+i[2]}else i=simplifyPoints(i,d);return t="M"+i.join(","),n&&n.setAttribute("d",t),t},rt.create=function(t,e){return new rt(t,e)},rt.editingAxis=O,rt.getSnapFunction=function(t){var r=t.radius||2,e=1e20,h=t.x||0===t.x?t.x:t.width?0:-e,l=t.y||0===t.y?t.y:t.height?0:-e,c=h+(t.width||1e40),d=l+(t.height||1e40),u=!1!==t.containX,p=!1!==t.containY,g=t.axis,_=t.gridSize;return r*=r,function(t){var e,n,i,s,a=t.x,o=t.y;u&&a<h||(i=a-h)*i<r?a=h:(u&&c<a||(i=c-a)*i<r)&&(a=c),p&&o<l||(s=o-l)*s<r?o=l:(p&&d<o||(s=d-o)*s<r)&&(o=d),g&&(i=a-g.x,s=o-g.y,i*i<r&&(a=g.x),s*s<r&&(o=g.y)),_&&(i=(e=h+Math.round((a-h)/_)*_)-a)*i+(s=(n=l+Math.round((o-l)/_)*_)-o)*s<r&&(a=e,o=n),t.x=a,t.y=o}},rt.version="3.0.0";function Ua(t){return"string"==typeof t}function Va(t,e){var n=ct.createElementNS?ct.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):ct.createElement(t);return n.style?n:ct.createElement(t)}function _a(t,e,n){return Ua(t)&&vt.test(t)?ct.querySelector(t):Array.isArray(t)?_t(gt([{x:ht.getProperty(e,"x"),y:ht.getProperty(e,"y")}].concat(t),n)):Ua(t)||t&&"path"===(t.tagName+"").toLowerCase()?t:0}function cb(t){return(t.transform.baseVal.consolidate()||mt).matrix}function eb(t,e){var n="Please gsap.registerPlugin(MotionPathPlugin)";lt=window,ht=ht||t||lt.gsap||console.warn(n),ct=document,ut=ct.body,dt=ct.documentElement,(pt=ht&&ht.plugins.motionPath)?(function _initCopyToClipboard(){(ft=Va("textarea")).style.display="none",ut.appendChild(ft)}(),gt=pt.arrayToRawPath,_t=pt.rawPathToString):!0===e&&console.warn(n)}
/*!
	 * MotionPathHelper 3.0.0
	 * https://greensock.com
	 *
	 * @license Copyright 2008-2019, GreenSock. All rights reserved.
	 * Subject to the terms at https://greensock.com/standard-license or for
	 * Club GreenSock members, the agreement issued with that membership.
	 * @author: Jack Doyle, jack@greensock.com
	*/
var ht,lt,ct,dt,ut,pt,gt,_t,ft,vt=/(^[#\.][a-z]|[a-y][a-z])/i,mt={matrix:{a:1,b:0,c:0,d:1,e:0,f:0}},bt=(MotionPathHelper.prototype.getString=function getString(){return this.editor.getString(!0,-this.offset.x,-this.offset.y)},MotionPathHelper);function MotionPathHelper(t,e){void 0===e&&(e={}),pt||eb(e.gsap,1);var n,i,s,a,o,r,h,l,c,d,u,p,g,_=Va("div"),f=this,v={x:0,y:0};t instanceof ht.core.Tween?n=(l=t).targets()[0]:(n=ht.utils.toArray(t)[0],l=function _findMotionPathTween(t){for(var e=ht.getTweensOf(t),n=0;n<e.length;n++){if(e[n].vars.motionPath)return e[n];e[n].timeline&&e.push.apply(e,e[n].timeline.getChildren())}}(n)),i=_a(e.path,n,e),this.offset=v,r=function _getPositionOnPage(t){var e=t.getBoundingClientRect(),n=dt.clientTop-(lt.pageYOffset||dt.scrollTop||ut.scrollTop||0),i=dt.clientLeft-(lt.pageXOffset||dt.scrollLeft||ut.scrollLeft||0);return{left:e.left+i,top:e.top+n,right:e.right+i,bottom:e.bottom+n}}(n),a=parseFloat(ht.getProperty(n,"x","px")),o=parseFloat(ht.getProperty(n,"y","px")),s=n.getCTM&&"svg"!==n.tagName.toLowerCase(),l&&!i&&(i=_a(l.vars.motionPath.path||l.vars.motionPath,n,l.vars.motionPath)),_.setAttribute("class","copy-motion-path"),_.style.cssText="border-radius:8px; background-color:rgba(85, 85, 85, 0.7); color:#fff; cursor:pointer; padding:6px 12px; font-family:Signika Negative, Arial, sans-serif; position:fixed; left:50%; transform:translate(-50%, 0); font-size:19px; bottom:10px",_.innerText="COPY MOTION PATH",_._gsHelper=f,(ht.utils.toArray(e.container)[0]||ut).appendChild(_),function _addCopyToClipboard(n,i,s){n.addEventListener("click",function(t){if(t.target._gsHelper){var e=i(t.target);if((ft.value=e)&&ft.select){console.log(e),ft.style.display="block",ft.select();try{ct.execCommand("copy"),ft.blur(),s&&s(n)}catch(t){console.warn("Copy didn't work; this browser doesn't permit that.")}ft.style.display="none"}}})}(_,function(){return f.getString()},function(){return ht.fromTo(_,{backgroundColor:"white"},{duration:.5,backgroundColor:"rgba(85, 85, 85, 0.6)"})}),(h=i&&i.ownerSVGElement)||(c=s&&n.ownerSVGElement&&n.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg",s?(h=n.ownerSVGElement,d=n.getBBox(),a=(u=cb(n)).e,o=u.f,v.x=d.x,v.y=d.y):(h=Va("svg",c),ut.appendChild(h),h.setAttribute("viewBox","0 0 100 100"),h.style.cssText="overflow:visible; background-color: transparent; position:absolute; width:100px; height:100px; top:"+r.top+"px; left:"+r.left+"px;"),d=Ua(i)&&!vt.test(i)?i:function _getInitialPath(t,e){var n,i=[0,31,8,58,24,75,40,90,69,100,100,100];for(n=0;n<i.length;n+=2)i[n]+=t,i[n+1]+=e;return"M"+t+","+e+"C"+i.join(",")}(a,o),(i=Va("path",c)).setAttribute("d",d),i.setAttribute("vector-effect","non-scaling-stroke"),i.style.cssText="fill:transparent; stroke-width:"+(e.pathWidth||3)+"; stroke:"+(e.pathColor||"#555")+"; opacity:"+(e.pathOpacity||.6),h.appendChild(i),(v.x||v.y)&&ht.set(i,{x:v.x,y:v.y})),"selected"in e||(e.selected=!0),"anchorSnap"in e||(e.anchorSnap=function(t){t.x*t.x+t.y*t.y<16&&(t.x=t.y=0)}),g=l&&"nested"===l.parent.data?l.parent.parent:l,e.onPress=function(){g.pause(0)},p=function refreshPath(){var t=cb(i);l.vars.motionPath.offsetX=t.e-v.x,l.vars.motionPath.offsetY=t.f-v.y,l.invalidate(),g.restart()},e.onRelease=e.onDeleteAnchor=p,this.editor=rt.create(i,e),e.center&&ht.set(n,{transformOrigin:"50% 50%",xPercent:-50,yPercent:-50}),l?(l.vars.motionPath.path?l.vars.motionPath.path=i:l.vars.motionPath={path:i},g.parent!==ht.globalTimeline&&ht.globalTimeline.add(g,function _getGlobalTime(t){for(var e=t.totalTime();t;)e=t.startTime()+e/(t.timeScale()||1),t=t.parent;return e}(g)-g.delay()),g.repeat(-1).repeatDelay(1)):l=g=ht.to(n,{motionPath:{path:i,start:e.start||0,end:"end"in e?e.end:1,autoRotate:"autoRotate"in e&&e.autoRotate},duration:e.duration||5,ease:e.ease||"Power1.easeInOut",repeat:-1,repeatDelay:1,paused:!e.path}),this.animation=l}bt.register=eb,bt.create=function(t,e){return new bt(t,e)},bt.version="3.0.0",t.MotionPathHelper=bt,t.default=bt,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=MotionPathHelper.min.js.map
